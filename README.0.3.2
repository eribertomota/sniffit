#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#
*                            Sniffit V.0.3.2                                  *
*                          By Brecht Claerhout                                *
#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#
*                        Patch 2: 0.3.1 -> 0.3.2                              *
#                                                                             #
*    Warning: All patches are follow up, so check the version number/patch    *
#             level before applying a new one.                                #
#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#*#

0. Introduction, and some stuff you should know.
	crap, credits and compilation notes ------> NEW COMPILATION
        READ THE PATCH INSTALL!
1. Use of the program
	NEW flags and examples
2. The output
	CHANGES / NEW output formats
     2.1. Loglevels
        explanation of the loglevels with '-L'
3. IMPORTANT NOTES, READ!
	new stuff.
4. BUGFIXES
5. NEW STUFF
	to keep track of what's in it
	and what is going to come 
------------------------------------------------------------------------------

0. Introduction, and some stuff you should know.
------------------------------------------------

Second patch.... hope you liked the last one ;)

BTW: you should read README.FIRST and IMPORTANT from 0.3.0 if you are a 
     new user! This file contains only ADDITIONAL info!

Whats new? 
Hhhmmmm........ Checksum checking (Sniffit does not chow any more "Bogus 
packets", those bogus packets could be ARP, RARP, other non-IP packets, 
real broken packets, ethernetcard failures). With -n you can DISABLE this 
opperating mode! (when you don't seem to receive any packets, try turning 
this off.... and report me this! Should be okay though).
The thing you have all been waiting for (yeah right) ;)
Logfile support..... well, it's only the start of it, it has a huge 
possibility of expansion, but allready includes some nice features.
A man file ... (what was that option again??) Install it, before you 'rm' 
the source code!
(The man file includes interesting info on what options can be mixed...)
Some bug fixes... including 'select from host' bug ... why didn't anyone 
report this????

Now, how to install the patch? Pretty simple..... put all the files of 
the package into the sniffit.0.3.0 directory (the dir with the sniffit 
sourcefiles).... once you have done that type "make -f Makepatch.0.3.1".
Do the same with the 0.3.2 patch....
Then compile it... compiling is a little different, see below.

The sniffer is still under development (no change there), so you'll find 
some parts that should be extended some more!

I use the libpcap library developped at Berkeley Laboratory, for easy 
porting (Read the licence).

Credits go to: 
    Wim Vandeputte, best friend and UNIX guru, for support, testing and 
                    providing me with a WWW site.
    Godmar Back, for fixing that kernel 1.2.X bug (Sniffit 0.1.X).
    Peter Kooiman, of Paradigm Systems Technology for providing the 
                   facilities to port Sniffit, and for the endless testing 
                   (although he laughs this away with "no big deal, I 
                   don't need no credits").
                   Without him, there would have been no ports at all.
    Brooke Paul, for providing me with an SGI account.
    Qing Long, for the bash/zsh libpcap/configure script.
    Guy Gustavson, for giving me a FreeBSD account. 
    Woju (woju@freebsd.ee.ntu.edu.tw), for the ncurses SunOS/FreeBSD fixing, 
                                       and for his other effords.
    Brian Beaulieu, for making a U.S. mirror site available! 
                    (see below for URL)
    everybody, who ever mailed me with sugestions help, etc...

This is free software, spread it if you want, but keep the package 
complete and unmodified. Do not use any code from this package without 
mentioning the source in your docs and advertisement. Do not use any of 
this code in Commercial Software/Commercial Packages.

Sugestions, comments and money ;) can be sent to:
  coder@reptile.rug.ac.be

  Brecht Claerhout
  Meulebeeksestw. 51
  8700 Tielt
  Belgium

The original distribution program can be optained from (my site): 
  http://reptile.rug.ac.be/~coder/sniffit/sniffit.html
U.S. mirror site (thank you Brian!):
  http://despair.capecod.net/sniffit/sniffit.html  

MIND YOU: this program is ran as root, and thus could easily contain 
          dangerous trojans. If you get it from the above site you can 
          safely compile and use it. 
          (no trojan versions are discovered yet.. it's just a warning)

Compiling (DIFFERENT FROM PREVIOUS VERSIONS):

Look at the "config.h" file for options. PLEASE CHECK THAT CONFIG FILE! 
We have a DIFFERENT compiling method now, type "make <system>".
Where <system> is one of:
	linux
	sunos
	irix	
	freebsd
(sunos: SunOS/Solaris)
(freebsd: PLEASE APPLY THE PATCH FIRST, READ IMPORTANT!!!)

Some things are still present (but less important):
make clean  : cleans all directories for a compiling from scratch
make config : needed for the compilation of libpcap
make sniffit_manual: look at the end of the makefile, this part is easily 
                     modified manually. If the program doesn't compile and 
                     you want to add some comliling options


1. Use of the program
---------------------

(Only new stuff listed)

Options:
  -v             Show version and exit (just added because it's such a 
                 wide spread option)

Parameters both modes (non-interactive and interactive):
  -n             Turn  of  IP  checksum  checking. This can show you
                 bogus packets.  (mind you ARP, RARP,  other  non-IP
                 packets  will  show  up bogus too) (compatible with
                 ALL options)

Parameters for not running in -i:
  Nothing new

Parameters with -i:
  Nothing new

Parameters with -c:
  -L <loglevel>	enable logging with <loglevel> as loglevel
  		currenly the following loglevels are supported:
		1     : Raw level 
		10,12 : Normal level 
                (see '2. The Output' for more info)

Format of the config file:

<field1> add-on:
   logfile     : change the logfile name to <field2> instead of the 
		 default 'sniffit.log'

<field2> add-on:
   a filename  : as an argument of 'logfile' in <field1>


  Maybe it would have been wise to mention explicitely, that the config-file 
  currently only works with TCP packets. 


2. The Output
------------- 

If you use a configfile (-c) and enable the Logging option a logfile is 
created. Unless you set 'logfile' in the config file, that file will be 
named 'sniffit.log'.
It will contain lines with the following FIXED format:

1) Date                       - Connection id.: message
   e.g. [Mon Aug 19 22:38:56 1996] - 100.100.10.10.1046-110.110.11.11.23: 
        Connection initiated.
        (conn. init. on the same line as the rest)

2) Except the starting line and the ending line of each session, they are:
   
   [Mon Aug 19 22:38:51 1996] - Sniffit session started.
   [Mon Aug 19 22:39:44 1996] - Sniffit session ended.

3) Lines containing other data (future versions), will NOT begin with '[' 
   and will have also easily interpretable formats.
   Other data is e.g. packet contence

I do this because I can imagine (when this is more expanded) that people 
will use their own parsers for these logfiles. Well, if you respect those 3 
rules, your parser will work on all future versions of Sniffit. 

2.1. Loglevels
--------------

Currently this is no big deal, and you will find this documentation to be 
a bit exagerated. But I wrote it this way, so that you would understand 
how I see further expansion of Sniffit.

Levels are divided into groups (1-9, 10-29, ..??) and within each group, 
they 'add' features to the logging mode.
e.g. loglevel 13, will do everything loglevel 12 does, and some 
     additional stuff...
     (this for future development)

Raw (levels 1-9)
  1 : 	Log all SYN, FIN, RST packets. This will give you an overview of 
	all network (TCP) trafic in a 'RAW' way (a connection starting could 
	gives you at least 2 SYN packets, etc...).
	Messages are:
		Connection initiated. (SYN)
		Connection ending. (FIN)
		Connection reset. (RST)

Normal (levels 10-29)
  10:  	Same as Raw level 1, but a bit more intelligent. Unless packets 
	are transmitted multiple times because of packet loss, you will 
	only get 1 notice of a connection starting or ending. (the packet id 
	will state the host that initiated the connection first)
	Messages are:
		Connection initiated.
		Connection closed.

  12:  This option will spy on trafic concerning ports 21 and 23 on the 
       subnet. Yes indeed, FTP and TELNET. Sniffit will try to catch login 
       and passwords for these applications.

       FTP
       Easy catching. Even multiple tries are registered.

       TELNET
       A bit harder. We only try to catch the first attempt, so if 
       someone fails the first login, you will miss his password.
       A '~' in the login and passwords fields can be a nonprintable 
       character (if in the beginning of a field, probably due to an early 
       start of registration) or a '~'. 
       This all makes it sound a little messy, but I 'testdrived' a lot and 
       was pleased with the results after adding some funky shit (if y'r 
       interested have a look at in function 'packethandler' in 
       sniffit.0.3.2.c)


3. IMPORTANT NOTES, READ!
-------------------------

Nothing changed


6. BUGFIXES
-----------

(PRIOR TO 0.2.0 - some are LINUX only)
   - Kernel 1.2.(some) incompatibility should be fixed. (like 1.2.5)
     (all credit for that to Godmar Back)
   - logging connections with lots of data is okay too now.
     'the integer that needed to be a long'-bug. 
     It was an overflow prob.
   - off course there are always minor ameliorations not worth mentioning

(SINCE 0.2.0)
   - MAXCOUNT bug 
   - interactive part lock-up bugs
   - output format 

(SINCE 0.3.0)
   - a wildcard bug
   - a Makefile bug (nothing important) 

(SINCE 0.3.1)
   - a typo caused the screwing up of the wildcard option (0.3.1)  
   - 'select from host' didn't work... 

7. NEW STUFF
------------

V.0.1.0
   - First test of the ncurses interface (never use this version, it's 
     megaslow)

V.0.1.1
   - Added '-x' for extra information on TCP packets
   - Added '-A <char>' for you 'password-horny-dudes' ;)  
   - beginning of ICMP support ('-P <protocol>')
   - First 'real' test for the interface

V.0.1.2
   - IP debugging info
   - UDP support
   - extended ICMP info (almost complete....)
   - logging on another terminal

V.0.2.0
   - SUN port (I now hate SPARC's ;)

V.0.2.1
   - SGI port

V.0.2.2
   - Netload statistics (interactive part)
   - Massive debugging of interactive part 

V.0.3.0
   - Wildcards in non-interactive mode
   - time-out in non interactive mode, so you won't stuff memory by 
     connections that weren't closed like they're supposed to be. 
   - Forcing the use of a snif device
   - MTU changeble in config.h
   - ppp use 

V.0.3.1
   - Flexible network trafic selection with config file.

V.0.3.2
   - IP checksum check
   - First introduction of a logfile for monitoring
   - Adding of loglevel: 1, 10, 12   

I'm working on (if you still believe me):
   - All the usual crap....
   - More monitoring utils... (I really am...)
   - debugging and optimizing (sigh...)

------------------------ Thx for using Sniffit(tm) ---------------------------
